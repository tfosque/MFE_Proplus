"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.loadFile = void 0;
const path_1 = __importDefault(require("path"));
const fs_1 = __importDefault(require("fs"));
const utils_1 = require("@strapi/utils");
const loadJsFile = (file) => {
    try {
        const jsModule = (0, utils_1.importDefault)(file);
        // call if function
        if (typeof jsModule === 'function') {
            return jsModule({ env: utils_1.env });
        }
        return jsModule;
    }
    catch (error) {
        if (error instanceof Error) {
            throw new Error(`Could not load js config file ${file}: ${error.message}`);
        }
        throw new Error('Unknown error');
    }
};
const loadJSONFile = (file) => {
    try {
        return (0, utils_1.templateConfiguration)(JSON.parse(fs_1.default.readFileSync(file).toString()));
    }
    catch (error) {
        if (error instanceof Error) {
            throw new Error(`Could not load json config file ${file}: ${error.message}`);
        }
        throw new Error('Unknown error');
    }
};
const loadFile = (file) => {
    const ext = path_1.default.extname(file);
    switch (ext) {
        case '.js':
            return loadJsFile(file);
        case '.json':
            return loadJSONFile(file);
        default:
            return {};
    }
};
exports.loadFile = loadFile;
//# sourceMappingURL=load-config-file.js.map