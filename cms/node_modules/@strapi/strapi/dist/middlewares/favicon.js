"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.favicon = void 0;
const fs_1 = require("fs");
const path_1 = require("path");
const koa_favicon_1 = __importDefault(require("koa-favicon"));
const defaults = {
    path: 'favicon.png',
    maxAge: 86400000,
};
const favicon = (config, { strapi }) => {
    const { maxAge, path: faviconDefaultPath } = { ...defaults, ...config };
    const { root: appRoot } = strapi.dirs.app;
    let faviconPath = faviconDefaultPath;
    /** TODO (v5): Updating the favicon to use a png caused
     *  https://github.com/strapi/strapi/issues/14693
     *
     *  This check ensures backwards compatibility until
     *  the next major version
     */
    if (!(0, fs_1.existsSync)((0, path_1.resolve)(appRoot, faviconPath))) {
        faviconPath = 'favicon.ico';
    }
    return (0, koa_favicon_1.default)((0, path_1.resolve)(appRoot, faviconPath), { maxAge });
};
exports.favicon = favicon;
//# sourceMappingURL=favicon.js.map