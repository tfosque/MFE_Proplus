"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
const data_transfer_1 = require("@strapi/data-transfer");
const utils_1 = require("@strapi/utils");
const data_transfer_2 = __importDefault(require("../../strategies/data-transfer"));
const { remote: { handlers: { createPushController, createPullController }, }, } = data_transfer_1.strapi;
const { UnauthorizedError } = utils_1.errors;
/**
 * @param {import('koa').Context} ctx
 * @param {string} [scope]
 */
const verify = async (ctx, scope) => {
    const { auth } = ctx.state;
    if (!auth) {
        throw new UnauthorizedError();
    }
    await data_transfer_2.default.verify(auth, { scope });
};
module.exports = {
    push: createPushController({ verify }),
    pull: createPullController({ verify }),
};
//# sourceMappingURL=runner.js.map