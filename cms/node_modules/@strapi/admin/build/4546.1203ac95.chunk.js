"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[4546],{17379:function(S,v,n){n.d(v,{r:function(){return P}});var f=n(32735),D=n(77981),M=n(60216),O=n.n(M),x=n(74506);function C(b,A,g){if(!b||!A)return{display:"none"};const{x:I,y:K}=g;return{transform:`translate(${I}px, ${K}px)`}}function P({renderItem:b}){const{itemType:A,isDragging:g,item:I,initialOffset:K,currentOffset:U,mouseOffset:B}=(0,x.useDragLayer)(L=>({item:L.getItem(),itemType:L.getItemType(),initialOffset:L.getInitialSourceClientOffset(),currentOffset:L.getSourceClientOffset(),isDragging:L.isDragging(),mouseOffset:L.getClientOffset()}));return g?f.createElement(D.x,{height:"100%",left:0,position:"fixed",pointerEvents:"none",top:0,zIndex:100,width:"100%"},f.createElement(D.x,{style:C(K,U,B)},b({type:A,item:I}))):null}P.propTypes={renderItem:O().func.isRequired}},75430:function(S,v,n){var f=n(32735);const D=(0,f.createContext)();var M=null},69242:function(S,v,n){n.d(v,{PL:function(){return x},Y9:function(){return C.Y},zE:function(){return oe},Ky:function(){return Q},fi:function(){return ne},zH:function(){return le},r5:function(){return a}});var f=n(32735),D=n(15062),M=n(53634),x=()=>{const e=(0,D.v9)(M.Z),t=(0,f.useCallback)(r=>e?.components?.[r]??{},[e]);return{...e,getComponentLayout:t}},C=n(77622),P=n(43806),b=n(84306),A=n(20716),g=n(97889);const I={error:null,isLoading:!0,layout:{},layouts:{}};var U=(e,t)=>(0,g.ZP)(e,r=>{switch(t.type){case"GET_DATA":{r.isLoading=!0,r.error=null,r.layout={};break}case"GET_DATA_SUCCEEDED":{const o=t.data.contentType.uid;r.layout=t.data,r.layouts[o]=t.data,r.isLoading=!1;break}case"GET_DATA_ERROR":{r.isLoading=!1,r.error=t.error;break}case"SET_LAYOUT_FROM_STATE":{r.error=null,r.layout=e.layouts[t.uid];break}case"UPDATE_LAYOUT":{const o=e.layout;r.layout={...o,contentType:{uid:o.contentType.uid,...t.newLayout.contentType}},r.layouts[o.contentType.uid]={...o,contentType:{uid:o.contentType.uid,...t.newLayout.contentType}};break}default:return r}}),B=n(99381),L=n.n(B),H=n(33795),R=n.n(H),se=n(3040),N=n.n(se),q=n(69997);const $=(e,t)=>t.find(r=>r.uid===e),ie=(e,t)=>{const r=_(e,t),o=k(r.contentType,t),u=ee(r.contentType,r.components);return N()(r,["contentType","layouts","edit"],o),N()(r,["contentType","layouts","list"],u),Object.keys(r.components).forEach(l=>{const m=k(r.components[l],t);N()(r,["components",l,"layouts","edit"],m)}),r},_=(e,t)=>{const r=(0,q.w8)(L()(e),t,"contentType"),{components:o,contentType:u}=r,l=m=>Object.keys(m.metadatas).reduce((T,h)=>{const j=R()(m,["attributes",h],{});let F=m.metadatas[h];if(j.type==="relation"){const ye=$(j.targetModel,t),W=F.edit.mainField,G={name:W,schema:R()(ye,["attributes",W])};F={list:{...F.list,mainField:G},edit:{...F.edit,mainField:G}}}return T[h]=F,T},{});return N()(r,["contentType","metadatas"],l(u)),Object.keys(o).forEach(m=>{const T=o[m],h=l(T);N()(r,["components",m,"metadatas"],h)}),r},k=(e,t)=>e.layouts.edit.reduce((r,o)=>{const u=o.map(l=>{const m=R()(e,["attributes",l.name],{}),T={...l,fieldSchema:m,metadatas:R()(e,["metadatas",l.name,"edit"],{})};if(m.type==="relation"){const j=$(m.targetModel,t).pluginOptions||{};N()(T,"targetModelPluginOptions",j),N()(T,"queryInfos",{shouldDisplayRelationLink:Y(e,l.name,t)})}return T});return r.push(u),r},[]),ee=(e,t)=>e.layouts.list.reduce((o,u)=>{const l=R()(e,["attributes",u],{}),m=R()(e,["metadatas",u,"list"],{}),T=l.type;if(T==="relation")return o.push({key:`__${u}_key__`,name:u,fieldSchema:l,metadatas:m}),o;if(T==="component"){const h=t[l.component],j=h.settings.mainField,F=h.attributes[j];return o.push({key:`__${u}_key__`,name:u,fieldSchema:l,metadatas:{...m,mainField:{...F,name:j}}}),o}return o.push({key:`__${u}_key__`,name:u,fieldSchema:l,metadatas:m}),o},[]),Y=(e,t,r)=>{const o=R()(e,["attributes",t,"targetModel"],"");return Z(r).includes(o)},Z=e=>e.filter(t=>t.isDisplayed).map(({uid:t})=>t);var V=ie,oe=e=>{const[{error:t,isLoading:r,layout:o,layouts:u},l]=(0,f.useReducer)(U,I),m=(0,f.useMemo)(A.Vo,[]),{schemas:T}=(0,D.v9)(W=>m(W),D.wU),h=(0,f.useRef)(!0),{get:j}=(0,P.kY)(),F=(0,f.useCallback)(async(W,G)=>{if(u[W]){l({type:"SET_LAYOUT_FROM_STATE",uid:W});return}l({type:"GET_DATA"});try{const{data:{data:re}}=await j(`/content-manager/content-types/${W}/configuration`,{cancelToken:G.token});l({type:"GET_DATA_SUCCEEDED",data:V(re,T)})}catch(re){if(b.default.isCancel(re))return;h.current&&console.error(re),h.current&&l({type:"GET_DATA_ERROR",error:re})}},[u,T,j]);(0,f.useEffect)(()=>()=>{h.current=!1},[]),(0,f.useEffect)(()=>{const G=b.default.CancelToken.source();return F(e,G),()=>{G.cancel("Operation canceled by the user.")}},[e,F]);const ye=(0,f.useCallback)(W=>{l({type:"UPDATE_LAYOUT",newLayout:V(W,T)})},[T]);return{error:t,isLoading:r,layout:o,updateLayout:ye}},ge=e=>e["content-manager_app"].collectionTypeLinks,ue=n(85973),p=n.n(ue),X=n(33348);const ae=(e,t)=>Object.keys(e).reduce((r,o)=>{const u=e[o],l=R()(t,[o],u);return p()(u)?{...r,[o]:ae(u,l)}:(r[o]=l,r)},{});var ce=(e,t,r)=>{const o=e.find(({to:F})=>F.includes(t));if(!o)return"/";const{to:u,search:l}=o,m=(0,X.parse)(l),T=(0,X.parse)(r.substring(1)),h=ae(m,T);return`${u}?${(0,X.stringify)(h,{encode:!1})}`},Q=e=>{const[{rawQuery:t}]=(0,P.Kx)(),r=(0,D.v9)(ge);return ce(r,e,t)},Te=n(15655),z=n(53038),ne=()=>{const{search:e}=(0,z.TH)(),t=e?(0,X.parse)(e.substring(1)):{};return t.plugins?(0,X.stringify)({plugins:t.plugins},{encode:!1}):""};const le=e=>{const t=(0,f.useRef)();return(0,f.useEffect)(()=>{t.current=e},[e]),t.current};var w=n(85149);const de=(e,t,r)=>({type:w.m,permissions:e,__meta__:{plugins:t,containerName:r}}),fe=()=>({type:w.Q}),me=e=>e["content-manager_rbacManager"].permissions,s=e=>e.rbacProvider.collectionTypesRelatedPermissions;var a=(e,t,r="listView")=>{const o=(0,D.I0)(),u=(0,D.v9)(s),l=(0,D.v9)(me),m=u[t];(0,f.useEffect)(()=>m?(o(de(m,e?e.plugins:null,r)),()=>{o(fe())}):()=>{},[m,o,e,r]);const T=l?.some(h=>h.subject!==t)??!0;return{isValid:l&&!T,permissions:l}},i=n(75430);const d=()=>useContext(WysiwygContext);var y=null},77622:function(S,v,n){n.d(v,{Y:function(){return x}});var f=n(32735),D=n(74506),M=n.n(D),O=n(15655);const x=(C,{type:P="STRAPI_DND",index:b,item:A={},onStart:g,onEnd:I,onGrabItem:K,onDropItem:U,onCancel:B,onMoveItem:L,dropSensitivity:H="regular"})=>{const R=(0,f.useRef)(null),[{handlerId:se},N]=(0,D.useDrop)({accept:P,collect(k){return{handlerId:k.getHandlerId()}},hover(k,ee){if(!R.current)return;const Y=k.index,Z=b;if(Y!==Z){if(H==="regular"){const V=R.current.getBoundingClientRect(),te=(V.bottom-V.top)/2,J=ee.getClientOffset().y-V.top;if(Y<Z&&J<te||Y>Z&&J>te)return}L(Z,Y),k.index=Z}}}),[{isDragging:q},$,ie]=(0,D.useDrag)({type:P,item(){g&&g();const{width:k}=R.current?.getBoundingClientRect()??{};return{index:b,width:k,...A}},end(){I&&I()},canDrag:C,isDragging:A.id?k=>A.id===k.getItem().id:void 0,collect:k=>({isDragging:k.isDragging()})}),_=(0,O.A)(C,b,{onGrabItem:K,onDropItem:U,onCancel:B,onMoveItem:L});return[{handlerId:se,isDragging:q,handleKeyDown:_},R,N,$,ie]}},15655:function(S,v,n){n.d(v,{A:function(){return D}});var f=n(32735);const D=(M,O,{onCancel:x,onDropItem:C,onGrabItem:P,onMoveItem:b})=>{const[A,g]=(0,f.useState)(!1),I=L=>{A&&(L==="UP"?b(O-1,O):L==="DOWN"&&b(O+1,O))},K=()=>{A?(C&&C(O),g(!1)):(P&&P(O),g(!0))},U=()=>{A&&(g(!1),x&&x(O))};return L=>{if(M&&!(L.key==="Tab"&&!A))switch(L.preventDefault(),L.key){case" ":case"Enter":K();break;case"Escape":U();break;case"ArrowDown":case"ArrowRight":I("DOWN");break;case"ArrowUp":case"ArrowLeft":I("UP");break;default:}}}},20716:function(S,v,n){n.d(v,{Jg:function(){return b},KQ:function(){return C},Vo:function(){return P},Yg:function(){return M}});var f=n(98178),D=n(60371);const M=()=>g=>g["content-manager_app"]||D.E,O=()=>createSelector(M(),g=>g),x=()=>createSelector(M(),g=>g.models),C=()=>(0,f.P1)(M(),g=>({collectionTypeLinks:g.collectionTypeLinks,singleTypeLinks:g.singleTypeLinks})),P=()=>(0,f.P1)(M(),({components:g,models:I})=>({schemas:[...g,...I]})),b=(0,f.P1)(M(),g=>g.fieldSizes);var A=null},53634:function(S,v){const n=f=>f["content-manager_editViewLayoutManager"].currentLayout;v.Z=n},24381:function(S,v){v.Z={COMPONENT:"component",EDIT_FIELD:"editField",FIELD:"field",DYNAMIC_ZONE:"dynamicZone",RELATION:"relation"}},48586:function(S,v,n){n.d(v,{G:function(){return f}});const f=({firstname:D,lastname:M,username:O,email:x},C)=>O||(D?C({id:"global.fullname",defaultMessage:"{firstname} {lastname}"},{firstname:D,lastname:M}).trim():x)},7921:function(S,v){const n=f=>`content-manager.${f}`;v.Z=n},69997:function(S,v,n){n.d(v,{_Q:function(){return Z.Z},W3:function(){return O},ko:function(){return C},FE:function(){return b},Di:function(){return K},Ex:function(){return fe},du:function(){return H},TA:function(){return N},Gf:function(){return me.G},Ts:function(){return _},Uo:function(){return ee},OB:function(){return Y.Z},w8:function(){return ue},kc:function(){return ae}});var f=n(99381),D=n.n(f),O=(s,c,a)=>{if(Array.isArray(s)&&c>=0&&a>=0&&c<=s.length-1&&a<=s.length-1){const i=D()(s),d=i.splice(c,1);return i.splice(a,0,d[0]),i}return s},C=s=>{const{type:c}=s;return c==="relation"?!(s?.relationType??"").toLowerCase().includes("morph"):!["json","dynamiczone","richtext","password"].includes(c)&&!!c};const P=(s,c)=>{typeof s=="function"?s(c):s!=null&&(s.current=c)},b=(...s)=>c=>s.forEach(a=>P(a,c));var A=n(33795),g=n.n(A);const I=(s,c)=>Object.keys(s).reduce((a,i)=>{const d=g()(s,[i],{}),{default:y,component:e,type:t,required:r,min:o,repeatable:u}=d;if(y!==void 0&&(a[i]=y),t==="component"){const l=c?.[e]?.attributes??{},m=I(l,c);if(r===!0&&(a[i]=u===!0?[]:m),o&&u===!0&&r){a[i]=[];for(let T=0;T<o;T+=1)a[i].push(m)}}return t==="dynamiczone"&&r===!0&&(a[i]=[]),a},{});var K=I,U=n(9086),B=n.n(U),H=({layouts:s,metadatas:c,...a})=>{const i=s.list.map(e=>e.name?e.name:e),d=Object.keys(c).reduce((e,t)=>{const r=g()(c,[t],{});let o=r.edit;return o.mainField&&(o={...o,mainField:r.edit.mainField.name}),{...e,[t]:{edit:o,list:B()(r.list,["mainField"])}}},{}),y=s.edit.map(e=>e.map(({name:t,size:r})=>({name:t,size:r})));return{...a,layouts:{edit:y,list:i},metadatas:d}};const R=(s,c)=>s.map(a=>({...a,subject:c}));var N=s=>{const c={create:[{action:"plugin::content-manager.explorer.create",subject:null}],delete:[{action:"plugin::content-manager.explorer.delete",subject:null}],publish:[{action:"plugin::content-manager.explorer.publish",subject:null}],read:[{action:"plugin::content-manager.explorer.read",subject:null}],update:[{action:"plugin::content-manager.explorer.update",subject:null}]};return Object.keys(c).reduce((a,i)=>(a[i]=R(c[i],s),a),{})},q=n(95919),$=n.n(q),_=s=>s.split(".").filter(c=>$()(parseInt(c,10))),ee=s=>{if(s.length===0)return-1;const c=Math.max.apply(Math,s.map(a=>a.__temp_key__??0));return Number.isNaN(c)?-1:c},Y=n(7921),Z=n(24381),V=n(86349),te=n.n(V),oe=n(3040),J=n.n(oe),ue=(s,c,a)=>{const i=t=>c.find(r=>r.uid===t),d=Object.assign({},s),y=s[a].uid,e=i(y);return J()(d,[a],te()({},e,s[a])),Object.keys(s.components).forEach(t=>{const r=i(t);J()(d,["components",t],{...s.components[t],...r})}),d},p=n(43806),ae=(s,c,a)=>{const i=(d,y)=>Object.keys(d).reduce((e,t)=>{const r=(0,p.UN)(y,t),o=g()(d,t),u=(0,p.k2)(y,[t,"component"]),l=(0,p.k2)(y,[t,"repeatable"]);return r==="dynamiczone"?(e[t]=o.map(m=>i(m,a[m.__component])),e):r==="component"?(l?e[t]=o&&o.map(m=>i(m,a[u])):e[t]=o&&i(o,a[u]),e):(r!=="password"&&(e[t]=o),e)},{});return i(s,c)},pe=n(51355),ce=n.n(pe),he=n(86834),Q=n.n(he),Te=n(78746),z=n.n(Te),E=n(24346),ne=n(73347);E.kM(E.nK,"defined",function(){return this.test("defined",p.I0.required,s=>s!==void 0)}),E.kM(E.IX,"notEmptyMin",function(s){return this.test("notEmptyMin",p.I0.min,c=>Q()(c)?!0:c.length>=s)}),E.kM(E.Z_,"isInferior",function(s,c){return this.test("isInferior",s,function(a){return!a||Number.isNaN(z()(a))?!0:z()(c)>=z()(a)})}),E.kM(E.Z_,"isSuperior",function(s,c){return this.test("isSuperior",s,function(a){return!a||Number.isNaN(z()(a))?!0:z()(a)>=z()(c)})});const le=s=>g()(s,["attributes"],{}),w=(s,{components:c},a={isCreatingEntry:!0,isDraft:!0,isFromComponent:!1,isJSONTestDisabled:!1})=>{const i=le(s);return E.Ry().shape(Object.keys(i).reduce((d,y)=>{const e=i[y];if(e.type!=="relation"&&e.type!=="component"&&e.type!=="dynamiczone"){const t=de(e.type,e,a);d[y]=t}if(e.type==="relation"&&(d[y]=["oneWay","oneToOne","manyToOne","oneToManyMorph","oneToOneMorph"].includes(e.relationType)?E.Ry().nullable():E.IX().nullable()),e.type==="component"){const t=w(c[e.component],{components:c},{...a,isFromComponent:!0});if(e.repeatable===!0){const{min:o,max:u,required:l}=e;let m=E.Vo(T=>{let h=E.IX().of(t);return o?l?h=h.min(o,p.I0.min):l!==!0&&Q()(T)?h=h.nullable():h=h.min(o,p.I0.min):l&&!a.isDraft&&(h=h.min(1,p.I0.required)),u&&(h=h.max(u,p.I0.max)),h});return d[y]=m,d}const r=E.Vo(o=>o!==void 0?e.required===!0&&!a.isDraft?t.defined():t.nullable():e.required===!0?E.Ry().defined():E.Ry().nullable());return d[y]=r,d}if(e.type==="dynamiczone"){let t=E.IX().of(E.Vo(({__component:u})=>w(c[u],{components:c},{...a,isFromComponent:!0})));const{max:r,min:o}=e;o?e.required?t=t.test("min",p.I0.min,u=>a.isCreatingEntry?u&&u.length>=o:u===void 0?!0:u!==null&&u.length>=o).test("required",p.I0.required,u=>a.isCreatingEntry?u!==null||u!==void 0:u===void 0?!0:u!==null):t=t.notEmptyMin(o):e.required&&!a.isDraft&&(t=t.test("required",p.I0.required,u=>a.isCreatingEntry?u!==null||u!==void 0:u===void 0?!0:u!==null)),r&&(t=t.max(r,p.I0.max)),d[y]=t}return d},{}))},de=(s,c,a)=>{let i=E.nK();return["string","uid","text","richtext","email","password","enumeration"].includes(s)&&(i=E.Z_()),s==="blocks"&&(i=E.nK().test("isJSON",p.I0.json,d=>a.isJSONTestDisabled||a.isDraft?!0:!!Array.isArray(d))),s==="json"&&(i=E.nK(p.I0.json).test("isJSON",p.I0.json,d=>{if(a.isJSONTestDisabled||!d||!d.length)return!0;try{return JSON.parse(d),!0}catch{return!1}}).nullable().test("required",p.I0.required,d=>!(c.required&&(!d||!d.length)))),s==="email"&&(i=i.email(p.I0.email)),["number","integer","float","decimal"].includes(s)&&(i=E.Rx().transform(d=>$()(d)?void 0:d).typeError()),s==="biginteger"&&(i=E.Z_().matches(/^-?\d*$/)),["date","datetime"].includes(s)&&(i=E.hT()),Object.keys(c).forEach(d=>{const y=c[d];if(y||!ce()(y)&&Number.isInteger(Math.floor(y))||y===0)switch(d){case"required":{a.isDraft||(s==="password"&&a.isCreatingEntry&&(i=i.required(p.I0.required)),s!=="password"&&(a.isCreatingEntry?i=i.required(p.I0.required):i=i.test("required",p.I0.required,e=>e===void 0&&!a.isFromComponent?!0:(0,ne.Z)(s)?e===0?!0:!!e:s==="boolean"?e!=null:s==="date"||s==="datetime"?typeof e=="string"?!Q()(e):!Q()(e?.toString()):!Q()(e))));break}case"max":{s==="biginteger"?i=i.isInferior(p.I0.max,y):i=i.max(y,p.I0.max);break}case"maxLength":i=i.max(y,p.I0.maxLength);break;case"min":{s==="biginteger"?i=i.isSuperior(p.I0.min,y):i=i.min(y,p.I0.min);break}case"minLength":{a.isDraft||(i=i.min(y,p.I0.minLength));break}case"regex":i=i.matches(new RegExp(y),{message:p.I0.regex,excludeEmptyString:!c.required});break;case"lowercase":["text","textarea","email","string"].includes(s)&&(i=i.strict().lowercase());break;case"uppercase":["text","textarea","email","string"].includes(s)&&(i=i.strict().uppercase());break;case"positive":(0,ne.Z)(s)&&(i=i.positive());break;case"negative":(0,ne.Z)(s)&&(i=i.negative());break;default:i=i.nullable()}}),i};var fe=w,me=n(48586)},73347:function(S,v,n){n.d(v,{Z:function(){return f}});function f(D){return["integer","biginteger","decimal","float","number"].includes(D)}}}]);
